<?xml version="1.0"?>
<meta_format>
<header>
 <format id='EASYS'/>
</header>
<data_format frame_type='multiplex' offset='16*{data_offset}' sample_type='int16'/> 
<parameters>
  <property id='magic' type='ascii' width='6' offset='0'/>
  <constraint test='{magic}.equals("EASREC")'/>
  <number_of_channels type='byte' offset='16' cached='true'/>
  <sampling_frequency evaltype='float' type='int16' offset='18' units='Hz'/>

  <property id='data_offset' type='int16' offset='28' cached='true'/>
  <property id='ext_hdr' type='uint16' offset='30' cached='true'/>
  <property id='SamplesInFile' type='int32' offset='20' cached='true'/>
  <property id='_calibration_gain' type='byte' offset='25' units='microVolts'/>

  <calibration_gain index='1..{number_of_channels}' evaltype='float' eval='1.0F/{_calibration_gain}' />

  <code language='java'>
  
   private int     offset_value;
   private boolean offset_value_set=false;
  
   private int easys_offset(int haveEx, int data_offset, int chn) throws XMLCodecException {
     if(offset_value_set==false) {
       if(haveEx==0) {
          throw new XMLCodecException(&#34;ex. header not found !&#34;);
       }
       
       int offset=32;
       for( ; ; ) {
          char  code1=(char)read_byte(offset), code2=(char)read_byte(offset+1);
          short size=read_short(offset+2);
          
          offset+=4;
          if(code1=='C' &#38;&#38; code2=='N') {
             break;
          } else if(code1=='\0' &#38;&#38; code2=='\0') {
             throw new XMLCodecException(&#34;channel names not found !&#34;);
          }
          offset+=size;
          if(offset &gt; 16*data_offset) {
             throw new XMLCodecException(&#34;channel names not found !&#34;);
          }
       }
       
       offset_value_set=true;
       offset_value=offset;
       //System.out.println(&#34; OFFSET &#34; + (16*offset));
       return offset;
     } else {
       return offset_value;
     }
   }
   
  </code>
  
  <channel_names type='ascii' width='4' 
                 offset='easys_offset({ext_hdr},{data_offset}, {number_of_channels})+4*({index}-1)'
                 index='1..{number_of_channels}'
                 />
  
</parameters> 
</meta_format>
